[tools]
bun = "latest"
uv = "latest"
"ubi:F1bonacc1/process-compose" = "latest"
age = "latest"
sops = "latest"
ruff = "latest"
taplo = "latest"

[env]
_.file = ".env.json"

DJANGO_DEBUG = true
DJANGO_LOG_LEVEL = "DEBUG"
NODE_ENV = "{{ env.NODE_ENV | default(value='development') }}"
VITE_API_URL = "http://127.0.0.1:8000/graphql"

[hooks]
postinstall = ['uv sync --directory ./backend/', 'bun install']

[tasks]
update = ['uv sync --upgrade --directory ./backend/', 'bun update']
manage = { run = "uv run ./manage.py", dir = './backend/' }
dev = "process-compose"
format = ["mise run ruff format .", "bun format"]
lint = ["mise run ruff check .", "bun lint"]
generate_secret_key = "uv run --with django python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'"
edit_secrets = "sops edit .env.json"
ruff = "uv run --directory ./backend/ ruff"

[settings]
experimental = true

pipx.uvx = true
